% ---------------------------------------------------------% DSB_TC.m% Matlab program example for DSB-TC AM modulation % The message signal is%        m(t) =  1  for 0 < t < 0.05%        m(t) = -2  for 0.05 < t < 0.1%        m(t) =  0  otherwise% ---------------------------------------------------------clearecho ondf=0.2;             % desired frequency resolution [Hz]ts=1/1000;        % sampling interval [sec]fs=1/ts;           % sampling frequencyfc=250;            % carrier frequencyT1=0; T2=0.15;    % observation time interval (from T1 to T2 sec)t=[T1:ts:T2];    % observation time vectorN=length(t);a=0.85;            % Modulation indexsnr=10;                              	% SNR in dB (logarithmic)snr_lin=10^(snr/10);                % SNR% message signalm=[ones(1,T2/(3*ts)),-2*ones(1,T2/(3*ts)),zeros(1,T2/(3*ts)+1)];s_c=cos(2*pi*fc.*t);                 % carrier signalm_n=m/max(abs(m));             % normalized message signal[M,m,df1]=fft_mod(m,ts,df);        % Fourier transform M=M/fs;                              	% scalingf=[0:df1:df1*(length(m)-1)]-fs/2;    	% frequency vector% modulated signals_m=(1+a*m_n).*s_c;     [S_m,s_m,df1]=fft_mod(s_m,ts,df);           	% Fourier transform S_m=S_m/fs;                              	% scalingsignal_power=norm(s_m(1:N))^2/N;     % power in modulated signal% power in normalized messagepmn=(norm(m(1:N))^2/N)/(max(abs(m)))^2;eta=(a^2*pmn)/(1+a^2*pmn);           	% modulation efficiencynoise_power=eta*signal_power/snr_lin;	% noise powernoise_std=sqrt(noise_power);         	% noise standard deviationnoise=noise_std*randn(1,length(s_m));  	% generate noiser=s_m+noise;                           	% add noise to the modulated signal[R,r,df1]=fft_mod(r,ts,df);           	% Fourier transform R=R/fs;                              	% scalingpause  % Press a key to show the modulated signal powersignal_powerpause  % Press a key to show the modulation efficiencyetapause  % Press any key to see a plot of the messageclf% ----------------------------------------------------------------% Time domain waveforms of message signal and modulated signal% ----------------------------------------------------------------subplot(2,1,1)plot(t,s_c(1:length(t)))xlabel('Time')title('Carrier waveform')pause  % Press any key to see the message signal waveformsubplot(2,1,1)plot(t,m(1:length(t)))axis([0 0.15 -2.1 2.1])xlabel('Time')title('Message signal')pause  % Press any key to see the modulated signal waveformsubplot(2,1,2)plot(t,s_m(1:length(t)))axis([0 0.15 -2.1 2.1])xlabel('Time')title('Modulated signal')pause   % Press any key to see the spectra % ----------------------------------------------------------------% Frequency domain plots of signal spectral% ----------------------------------------------------------------subplot(2,1,1)plot(f,abs(fftshift(M)))xlabel('Frequency')title('Spectrum of the message signal')subplot(2,1,2)plot(f,abs(fftshift(S_m)))title('Spectrum of the modulated signal')xlabel('Frequency')pause  % Press a key to see a noise sample% ----------------------------------------------------------------% Waveform and spectrum of signal plus noise% ----------------------------------------------------------------clfsubplot(2,1,1)plot(t,noise(1:length(t)))title('noise sample') xlabel('Time')subplot(2,1,2)plot(t,r(1:length(t)))title('Signal and noise')xlabel('Time')pause  % Press a key to see spectra of modulated signal and noisesubplot(2,1,1)plot(f,abs(fftshift(S_m)))title('Signal spectrum')xlabel('Frequency')subplot(2,1,2)plot(f,abs(fftshift(R))) title('Signal and noise spectrum')xlabel('Frequency')