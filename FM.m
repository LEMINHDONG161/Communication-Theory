% ---------------------------------------------------------% FM.m% Matlab program example for FM modulation % Message signals are:% Signal 1: multilevel rectangular pulse sequence%        m(t) =  1  for 0 < t < 0.05%        m(t) = -2  for 0.05 < t < 0.1%        m(t) =  0  otherwise%% Signal 2: triangular pulse with pulse width tau2=0.1% ---------------------------------------------------------clear; close allecho ondf=0.2              % desired frequency resolution [Hz]ts=1/2000;        % sampling interval [sec]fs=1/ts;           % sampling frequencyfc=300;            % carrier frequencykf=50;             % frequency sensitivity [Hz/volt]% ------------------------------------------------------% For signal 1: multilevel rectangular pulse sequence% ------------------------------------------------------T1=0; T2=0.15;    % observation time interval (from T1 to T2 sec)t=[T1:ts:T2];    % observation time vector% message signalm=[ones(1,T2/(3*ts)),-2*ones(1,T2/(3*ts)),zeros(1,T2/(3*ts)+1)];integ_m(1)=0;for i=1:length(t)-1                  	% integral of m  integ_m(i+1)=integ_m(i)+m(i)*ts;  echo off ;endecho on ;[M,m,df1]=fft_mod(m,ts,df);             % Fourier transform of message signalM=M/fs;                              	       % scalingf=[0:df1:df1*(length(m)-1)]-fs/2;    	% frequency vectors_m=cos(2*pi*(fc*t + kf*integ_m));    % modulated signal[S_m,s_m,df1]=fft_mod(s_m,ts,df);    % Fourier transform of modulated signalS_m=S_m/fs;                              	 % scalingpause  % Press any key to see the signal waveformsubplot(2,1,1)plot(t,m(1:length(t)))axis([T1 T2 -2.1 2.1])xlabel('Time')title('Message signal')subplot(2,1,2)plot(t,s_m(1:length(t)))axis([T1 T2 -2.1 2.1])xlabel('Time')title('Modulated signal')pause   % Press any key to see the spectrumsubplot(2,1,1)plot(f,abs(fftshift(M))) xlabel('Frequency')title('Magnitude spectrum of the message signal')subplot(2,1,2)plot(f,abs(fftshift(S_m))) title('Magnitude spectrum of the modulated signal')xlabel('Frequency')pause   % Press any key to continue for signal 2% -------------------------------------------------------------------% For signal 2: triangular pulse with pulse width tau2=0.1 and amplitude=2% -------------------------------------------------------------------T1=-0.1; T2=0.1;    % observation time interval (from T1 to T2 sec)t=[T1:ts:T2];    % observation time vector% message signaltau2=0.1; % Pulse width [sec]m=2*triangle(tau2, T1, T2, fs, df);integ_m(1)=0;for i=1:length(t)-1                  	% integral of m  integ_m(i+1)=integ_m(i)+m(i)*ts;  echo off ;endecho on ;[M,m,df1]=fft_mod(m,ts,df);             % Fourier transform of message signalM=M/fs;                              	       % scalingf=[0:df1:df1*(length(m)-1)]-fs/2;    	% frequency vectors_m=cos(2*pi*(fc*t + kf*integ_m));    % modulated signal[S_m,s_m,df1]=fft_mod(s_m,ts,df);    % Fourier transform of modulated signalS_m=S_m/fs;                              	 % scalingpause  % Press any key to see the signal waveformfigure;subplot(2,1,1)plot(t,m(1:length(t)))axis([T1 T2 -2.1 2.1])xlabel('Time')title('Message signal')subplot(2,1,2)plot(t,s_m(1:length(t)))axis([T1 T2 -2.1 2.1])xlabel('Time')title('Modulated signal')pause   % Press any key to see the spectrumsubplot(2,1,1)plot(f,abs(fftshift(M))) xlabel('Frequency')title('Magnitude spectrum of the message signal')subplot(2,1,2)plot(f,abs(fftshift(S_m))) title('Magnitude spectrum of the modulated signal')xlabel('Frequency')