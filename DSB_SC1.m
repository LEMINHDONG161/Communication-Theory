% DSB_SC1.m% Matlab program example for DSBSC-AM modulation % The message signal is triangular pulse with pulse width tau2=0.1%clearecho ondf=0.3;             % desired frequency resolution [Hz]ts=1/1000;        % sampling interval [sec]fs=1/ts;           % sampling frequencyfc=250;            % carrier frequencyT1=-0.1; T2=0.1;    % observation time interval (from T1 to T2 sec)t=[T1:ts:T2];    % observation time vectorN = length(t);snr=20;                          % SNR in dB (logarithmic)snr_lin=10^(snr/10);        % linear SNR% message signaltau2=0.1; % Pulse width [sec]x=triangle(tau2, T1, T2, fs, df);xc=cos(2*pi*fc.*t);             % carrier signalxm=x.*xc;                        % mixing (xm is modulated signal)[X,x,df1]=fft_mod(x,ts,df);     % Fourier transform of message signalX=X/fs;                            % scaling                 f=[0:df1:df1*(length(x)-1)]-fs/2; %frequency vector (range to plot)[Xm,xm,df1]=fft_mod(xm,ts,df);     % Fourier transform of modulated signalXm=Xm/fs;                            % scaling[XC,xc,df1]=fft_mod(xc,ts,df);    % Fourier transform of carriersignal_power=norm(xm(1:N))^2/N;   	% power in modulated signalnoise_power=signal_power/snr_lin;    	% compute noise powernoise_std=sqrt(noise_power);         	% compute noise standard deviationnoise=noise_std*randn(1,length(xm));  	% generate noiser=xm+noise;                           	% add noise to the modulated signal[R,r,df1]=fft_mod(r,ts,df);           	% spectrum of the signal+noise R=R/fs;                              	% scaling%pause  % Press a key to show the modulated signal powersignal_powerpause  % Press any key to see the message signal waveformclf% ----------------------------------------------------------------% Time domain waveforms of message signal and modulated signal% ----------------------------------------------------------------subplot(2,1,1)plot(t,xc(1:length(t)))xlabel('Time')title('Carrier waveform')pause  % Press any key to see the message signal waveformsubplot(2,1,1)plot(t,x(1:length(t)))xlabel('Time')title('Message signal')pause  % Press any key to see the modulated signal waveformsubplot(2,1,2)plot(t,xm(1:length(t)))xlabel('Time')title('Modulated signal')pause   % Press any key to see the spectra % ----------------------------------------------------------------% Frequency domain plots of signal spectral% ----------------------------------------------------------------subplot(2,1,1)plot(f,abs(fftshift(X)))xlabel('Frequency')title('Spectrum of the message signal')subplot(2,1,2)plot(f,abs(fftshift(Xm)))title('Spectrum of the modulated signal')xlabel('Frequency')pause  % Press a key to see a noise sample% ----------------------------------------------------------------% Waveform and spectrum of signal plus noise% ----------------------------------------------------------------clfsubplot(2,1,1)plot(t,noise(1:length(t)))title('noise sample') xlabel('Time')pause  % Press a key to see the modulated signal and noise subplot(2,1,2)plot(t,r(1:length(t)))title('Signal and noise')xlabel('Time')pause  % Press a key to see spectra of modulated signal and noisesubplot(2,1,1)plot(f,abs(fftshift(Xm)))title('Signal spectrum')xlabel('Frequency')subplot(2,1,2)plot(f,abs(fftshift(R))) title('Signal and noise spectrum')xlabel('Frequency')